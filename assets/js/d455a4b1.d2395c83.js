"use strict";(self.webpackChunkocp_saurus_2=self.webpackChunkocp_saurus_2||[]).push([[2622],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>k});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(a),d=r,k=c["".concat(s,".").concat(d)]||c[d]||m[d]||l;return a?n.createElement(k,o(o({ref:t},u),{},{components:a})):n.createElement(k,o({ref:t},u))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,o=new Array(l);o[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:r,o[1]=i;for(var p=2;p<l;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},5162:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(7294),r=a(6010);const l="tabItem_Ymn6";function o(e){let{children:t,hidden:a,className:o}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(l,o),hidden:a},t)}},5488:(e,t,a)=>{a.d(t,{Z:()=>d});var n=a(7462),r=a(7294),l=a(6010),o=a(2389),i=a(7392),s=a(7094),p=a(2466);const u="tabList__CuJ",c="tabItem_LNqP";function m(e){const{lazy:t,block:a,defaultValue:o,values:m,groupId:d,className:k}=e,h=r.Children.map(e.children,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),N=m??h.map((e=>{let{props:{value:t,label:a,attributes:n}}=e;return{value:t,label:a,attributes:n}})),g=(0,i.l)(N,((e,t)=>e.value===t.value));if(g.length>0)throw new Error(`Docusaurus error: Duplicate values "${g.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const f=null===o?o:o??h.find((e=>e.props.default))?.props.value??h[0].props.value;if(null!==f&&!N.some((e=>e.value===f)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${f}" but none of its children has the corresponding value. Available values are: ${N.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:b,setTabGroupChoices:y}=(0,s.U)(),[v,w]=(0,r.useState)(f),C=[],{blockElementScrollPositionUntilNextRender:O}=(0,p.o5)();if(null!=d){const e=b[d];null!=e&&e!==v&&N.some((t=>t.value===e))&&w(e)}const x=e=>{const t=e.currentTarget,a=C.indexOf(t),n=N[a].value;n!==v&&(O(t),w(n),null!=d&&y(d,String(n)))},I=e=>{let t=null;switch(e.key){case"Enter":x(e);break;case"ArrowRight":{const a=C.indexOf(e.currentTarget)+1;t=C[a]??C[0];break}case"ArrowLeft":{const a=C.indexOf(e.currentTarget)-1;t=C[a]??C[C.length-1];break}}t?.focus()};return r.createElement("div",{className:(0,l.Z)("tabs-container",u)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":a},k)},N.map((e=>{let{value:t,label:a,attributes:o}=e;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:v===t?0:-1,"aria-selected":v===t,key:t,ref:e=>C.push(e),onKeyDown:I,onClick:x},o,{className:(0,l.Z)("tabs__item",c,o?.className,{"tabs__item--active":v===t})}),a??t)}))),t?(0,r.cloneElement)(h.filter((e=>e.props.value===v))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},h.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==v})))))}function d(e){const t=(0,o.Z)();return r.createElement(m,(0,n.Z)({key:String(t)},e))}},9464:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));a(5488),a(5162);const l={sidebar_position:7,title:"Option 2: Nutanix CSI Deployment using OperatorHub"},o="Option 2: Nutanix CSI deployment for OCP",i={unversionedId:"ocp_ntnx_hci/ocp_csi2",id:"ocp_ntnx_hci/ocp_csi2",title:"Option 2: Nutanix CSI Deployment using OperatorHub",description:"In this section we will enable your deployed OCP cluster to have access to Nutanix HCI storage in the form of StorageClass, Physical Volumes and Pysical Volume claims.",source:"@site/docs/ocp_ntnx_hci/ocp_csi2.mdx",sourceDirName:"ocp_ntnx_hci",slug:"/ocp_ntnx_hci/ocp_csi2",permalink:"/ocp-saurus2/ocp_ntnx_hci/ocp_csi2",draft:!1,editUrl:"https://github.com/mat0606/ocp-saurus2/edit/main/docs/ocp_ntnx_hci/ocp_csi2.mdx",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7,title:"Option 2: Nutanix CSI Deployment using OperatorHub"},sidebar:"tutorialSidebar",previous:{title:"Option 1: Nutanix CSI Deployment using NCM Self Service",permalink:"/ocp-saurus2/ocp_ntnx_hci/ocp_csi"},next:{title:"CSI Metric Monitor with Prometheus",permalink:"/ocp-saurus2/ocp_ntnx_hci/ocp_csi_prometheus"}},s={},p=[{value:"Install Nutanix CSI Operator",id:"install-nutanix-csi-operator",level:2}],u={toc:p};function c(e){let{components:t,...l}=e;return(0,r.kt)("wrapper",(0,n.Z)({},u,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"option-2-nutanix-csi-deployment-for-ocp"},"Option 2: Nutanix CSI deployment for OCP"),(0,r.kt)("p",null,"In this section we will enable your deployed OCP cluster to have access to Nutanix HCI storage in the form of StorageClass, Physical Volumes and Pysical Volume claims."),(0,r.kt)("p",null,"We will also install kubernetes operator provided by Nutanix to maintain the lifecycle of operator."),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"https://docs.openshift.com/container-platform/4.9/operators/understanding/olm-what-operators-are.html"},"What are Kubernetes Operators?")," for more information."),(0,r.kt)("p",null,"OpenShift provides a easy way of implementing these third-party operators via OperatorHub from the cluster manager GUI ."),(0,r.kt)("p",null,"As the Nutanix CSI Operator provides the following capabilities as of now, we will install it to manage all our Nutanix StorageClass in this OCP cluster."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Basic install"),(0,r.kt)("li",{parentName:"ul"},"Seamless upgrades (Manual or Automatic)")),(0,r.kt)("p",null,"In future Nutanix CSI Operator may provide the following additional features:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Full lifecycle"),(0,r.kt)("li",{parentName:"ul"},"Deep insights"),(0,r.kt)("li",{parentName:"ul"},"Autopilot")),(0,r.kt)("p",null,"Nutanix CSI supports Nutanix Volumes and Nutanix Files as backend data storage systems."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Storage Class Mode"),(0,r.kt)("th",{parentName:"tr",align:null},"ReadWriteOnce"),(0,r.kt)("th",{parentName:"tr",align:null},"ReadOnlyMany"),(0,r.kt)("th",{parentName:"tr",align:null},"ReadWriteMany"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Nutanix Volumes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Nutanix Files"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes")))),(0,r.kt)("p",null,"In this lab, we will deploy both Nutanix Volumes and Files Storage Class and use them throughout the bootcamp."),(0,r.kt)("h2",{id:"install-nutanix-csi-operator"},"Install Nutanix CSI Operator"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Login to you Windows Tools VM using the following credentials;"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Username")," - ",(0,r.kt)("a",{parentName:"li",href:"mailto:administrator@ntnxlab.local"},"administrator@ntnxlab.local")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Password")," - nutanix/4u"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Using Chrome browser browse to Console URL you obtained in the previous section."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-url"},"https://console-openshift-console.apps.<initials>1.ntnxlab.local\n")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-url"},"# example URL\n# https://console-openshift-console.apps.xyz1.ntnxlab.local\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Use your credentials to Login"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Username")," - kubeadmin"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Password")," - password from previous section"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click on ",(0,r.kt)("strong",{parentName:"p"},"Log in")," (if you are not already logged in)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click on ",(0,r.kt)("strong",{parentName:"p"},"Operator")," > ",(0,r.kt)("strong",{parentName:"p"},"Operator Hub"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"You will see all third party operators categorised by solution driven use cases (e.g. Big Data, Database, etc)"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(7170).Z,width:"1636",height:"725"})),(0,r.kt)("p",{parentName:"li"},"This is in principle similar to Nutanix Calm Marketplace where you can request and install applications.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In the ",(0,r.kt)("strong",{parentName:"p"},"Filter by Keyword")," text box, type ",(0,r.kt)("strong",{parentName:"p"},"Nutanix")," to find the Nutanix CSI Operator")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click on the ",(0,r.kt)("strong",{parentName:"p"},"Nutanix CSI Operator"),", verify Operator version to be at least ",(0,r.kt)("inlineCode",{parentName:"p"},"2.6.2")," and click on ",(0,r.kt)("strong",{parentName:"p"},"Install")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(806).Z,width:"1296",height:"682"})),(0,r.kt)("p",{parentName:"li"},"Also make sure to check the supported orchestration (RH OCP platforms)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In the Operator install wizard choose the following:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Update channel")," - stable"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Operator recommended Namespace")," - ",(0,r.kt)("inlineCode",{parentName:"li"},"openshift-cluster-csi-drivers")," (automatically chosen)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Update approval")," - Automatic (admins usually choose Manual option where control over updates is necessary)")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(304).Z,width:"864",height:"818"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click on ",(0,r.kt)("strong",{parentName:"p"},"Install"),".  It will takes a few minutes."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(6114).Z,width:"910",height:"392"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click on ",(0,r.kt)("strong",{parentName:"p"},"View Operator"),".  Once installed you will also see the operator in ",(0,r.kt)("strong",{parentName:"p"},"Operator")," > ",(0,r.kt)("strong",{parentName:"p"},"Installed Operators")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(3830).Z,width:"983",height:"403"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click on ",(0,r.kt)("strong",{parentName:"p"},"Create Instance")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(7030).Z,width:"980",height:"485"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click on ",(0,r.kt)("strong",{parentName:"p"},"Create")," button"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(9968).Z,width:"990",height:"610"})))),(0,r.kt)("p",null,"This will create a NutanixCsiStorage resource to deploy your driver."),(0,r.kt)("ol",{start:14},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"You have succesfully installed the Nutanix CSI operator to take care of StorageClass installation and upgrades.  "),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{src:a(8074).Z,width:"1391",height:"656"})))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"OCP Operators can also be installed using ",(0,r.kt)("inlineCode",{parentName:"p"},"oc")," commandline. For more information refer to OCP documentation ",(0,r.kt)("a",{parentName:"p",href:"https://docs.openshift.com/container-platform/4.7/operators/admin/olm-adding-operators-to-cluster.html#olm-installing-operator-from-operatorhub-using-cli_olm-adding-operators-to-a-cluster"},"here.")),(0,r.kt)("p",{parentName:"admonition"},"Nutanix CSI can also be installed using ",(0,r.kt)("inlineCode",{parentName:"p"},"helm")," charts as well as you would do in any implementation of kubernetes. See ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nutanix/csi-plugin"},"here")," for more details. ")))}c.isMDXComponent=!0},806:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Install-CSI-1-01916119ceb4f7ca8bd576a9df0f7f5d.png"},6114:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Install-CSI-3-e7a809234c346728fc43c191a4f69a88.png"},3830:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Install-CSI-4-325abaa66f22e58a95974bdbb3345480.png"},7030:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Install-CSI-5-024fba03f1ab1dda8e932a7b064b42f5.png"},9968:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Install-CSI-6-3e2348675e30e6e49ae406214daeffd8.png"},8074:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Install-CSI-7-2609f3dc761a497523f04dbb17a7e1b1.png"},7170:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/ocp_operator_hub-1ec225aa0eea79228ffabfab2b9c2563.png"},304:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/ocp_operator_install_options-809c46f9f485f94783a689398b63fe94.png"}}]);